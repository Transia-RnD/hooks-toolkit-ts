const ASSERT = (x, code) => {
  if (!x) {
    trace('error', 0, false)
    rollback(x.toString(), code)
  }
}

const Hook = (arg) => {
  let raw = [
    0x72, 0x4e, 0x36, 0x53, 0x59, 0x77, 0x72, 0x32, 0x64, 0x54, 0x56, 0x43,
    0x7a, 0x45, 0x71, 0x39, 0x57, 0x43, 0x77, 0x4a,
  ]
  let hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x42 &&
      hash[1] == 0x5c &&
      hash[2] == 0x4c &&
      hash[3] == 0x01 &&
      hash[4] == 0x84 &&
      hash[5] == 0xa5 &&
      hash[6] == 0x76 &&
      hash[7] == 0x79 &&
      hash[8] == 0xdc &&
      hash[9] == 0x6d &&
      hash[10] == 0xff &&
      hash[11] == 0x40 &&
      hash[12] == 0x8c &&
      hash[13] == 0x29 &&
      hash[14] == 0x06 &&
      hash[15] == 0x6b &&
      hash[16] == 0x0f &&
      hash[17] == 0xb9 &&
      hash[18] == 0xea &&
      hash[19] == 0x34
  )

  raw = [
    0x72, 0x4b, 0x4b, 0x75, 0x52, 0x36, 0x36, 0x46, 0x62, 0x38, 0x33, 0x76,
    0x35, 0x71, 0x79, 0x41, 0x34, 0x48, 0x67, 0x6a,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x36 &&
      hash[1] == 0x2c &&
      hash[2] == 0x32 &&
      hash[3] == 0x1d &&
      hash[4] == 0x8d &&
      hash[5] == 0xdd &&
      hash[6] == 0xaf &&
      hash[7] == 0x2d &&
      hash[8] == 0x3c &&
      hash[9] == 0xe6 &&
      hash[10] == 0x94 &&
      hash[11] == 0x12 &&
      hash[12] == 0x20 &&
      hash[13] == 0xda &&
      hash[14] == 0x62 &&
      hash[15] == 0xa6 &&
      hash[16] == 0x98 &&
      hash[17] == 0x41 &&
      hash[18] == 0x04 &&
      hash[19] == 0x5e
  )

  raw = [
    0x72, 0x42, 0x54, 0x33, 0x58, 0x57, 0x43, 0x76, 0x61, 0x38, 0x48, 0x55,
    0x4e, 0x4e, 0x5a, 0x46, 0x6a, 0x5a, 0x43, 0x55,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xcf &&
      hash[1] == 0xfd &&
      hash[2] == 0x6f &&
      hash[3] == 0x01 &&
      hash[4] == 0x95 &&
      hash[5] == 0x76 &&
      hash[6] == 0x7d &&
      hash[7] == 0xfb &&
      hash[8] == 0xca &&
      hash[9] == 0x41 &&
      hash[10] == 0xfd &&
      hash[11] == 0x24 &&
      hash[12] == 0x23 &&
      hash[13] == 0xd6 &&
      hash[14] == 0x82 &&
      hash[15] == 0x20 &&
      hash[16] == 0x76 &&
      hash[17] == 0xdd &&
      hash[18] == 0xc9 &&
      hash[19] == 0xec
  )

  raw = [
    0x72, 0x4c, 0x52, 0x4c, 0x41, 0x6e, 0x61, 0x62, 0x56, 0x6f, 0x46, 0x62,
    0x37, 0x47, 0x68, 0x79, 0x58, 0x75, 0x42, 0x53,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x02 &&
      hash[1] == 0xeb &&
      hash[2] == 0x2f &&
      hash[3] == 0x30 &&
      hash[4] == 0xfc &&
      hash[5] == 0x73 &&
      hash[6] == 0x34 &&
      hash[7] == 0xe7 &&
      hash[8] == 0x89 &&
      hash[9] == 0xa2 &&
      hash[10] == 0x58 &&
      hash[11] == 0xd6 &&
      hash[12] == 0xb0 &&
      hash[13] == 0x55 &&
      hash[14] == 0x32 &&
      hash[15] == 0x96 &&
      hash[16] == 0xb5 &&
      hash[17] == 0x2e &&
      hash[18] == 0x97 &&
      hash[19] == 0x81
  )

  raw = [
    0x72, 0x4c, 0x37, 0x33, 0x39, 0x47, 0x4b, 0x35, 0x75, 0x36, 0x79, 0x78,
    0x76, 0x43, 0x73, 0x6f, 0x68, 0x43, 0x32, 0x43,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x9f &&
      hash[1] == 0xd4 &&
      hash[2] == 0x7c &&
      hash[3] == 0x25 &&
      hash[4] == 0xde &&
      hash[5] == 0x23 &&
      hash[6] == 0x97 &&
      hash[7] == 0x57 &&
      hash[8] == 0xed &&
      hash[9] == 0x25 &&
      hash[10] == 0xd0 &&
      hash[11] == 0x98 &&
      hash[12] == 0xf7 &&
      hash[13] == 0x83 &&
      hash[14] == 0x70 &&
      hash[15] == 0xf6 &&
      hash[16] == 0x5f &&
      hash[17] == 0x3d &&
      hash[18] == 0xb5 &&
      hash[19] == 0x43
  )

  raw = [
    0x72, 0x4d, 0x4d, 0x45, 0x57, 0x74, 0x75, 0x4b, 0x43, 0x77, 0x54, 0x43,
    0x36, 0x31, 0x78, 0x41, 0x78, 0x35, 0x55, 0x46,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x77 &&
      hash[1] == 0x59 &&
      hash[2] == 0x43 &&
      hash[3] == 0x6b &&
      hash[4] == 0x4d &&
      hash[5] == 0x11 &&
      hash[6] == 0x6b &&
      hash[7] == 0xe5 &&
      hash[8] == 0xf8 &&
      hash[9] == 0x90 &&
      hash[10] == 0x07 &&
      hash[11] == 0x00 &&
      hash[12] == 0xb3 &&
      hash[13] == 0xb2 &&
      hash[14] == 0x6b &&
      hash[15] == 0x8a &&
      hash[16] == 0xc8 &&
      hash[17] == 0xf2 &&
      hash[18] == 0x82 &&
      hash[19] == 0xb7
  )

  raw = [
    0x72, 0x66, 0x48, 0x6a, 0x66, 0x31, 0x6b, 0x70, 0x4b, 0x6a, 0x39, 0x66,
    0x6a, 0x39, 0x35, 0x58, 0x6a, 0x59, 0x69, 0x51,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xbd &&
      hash[1] == 0x1b &&
      hash[2] == 0xdd &&
      hash[3] == 0x9d &&
      hash[4] == 0x10 &&
      hash[5] == 0xde &&
      hash[6] == 0x24 &&
      hash[7] == 0xa1 &&
      hash[8] == 0xb2 &&
      hash[9] == 0x6c &&
      hash[10] == 0x24 &&
      hash[11] == 0xbc &&
      hash[12] == 0xf9 &&
      hash[13] == 0x97 &&
      hash[14] == 0x50 &&
      hash[15] == 0xde &&
      hash[16] == 0x93 &&
      hash[17] == 0x39 &&
      hash[18] == 0x58 &&
      hash[19] == 0x21
  )

  raw = [
    0x72, 0x66, 0x6e, 0x75, 0x57, 0x38, 0x77, 0x6f, 0x4b, 0x62, 0x6e, 0x57,
    0x4b, 0x6b, 0x6b, 0x75, 0x39, 0x6a, 0x79, 0x64,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x3b &&
      hash[1] == 0x89 &&
      hash[2] == 0xed &&
      hash[3] == 0x68 &&
      hash[4] == 0x0d &&
      hash[5] == 0x13 &&
      hash[6] == 0x3b &&
      hash[7] == 0x1d &&
      hash[8] == 0x43 &&
      hash[9] == 0xfe &&
      hash[10] == 0xae &&
      hash[11] == 0x3e &&
      hash[12] == 0xc3 &&
      hash[13] == 0x90 &&
      hash[14] == 0xe8 &&
      hash[15] == 0x0e &&
      hash[16] == 0x17 &&
      hash[17] == 0x14 &&
      hash[18] == 0x23 &&
      hash[19] == 0x71
  )

  raw = [
    0x72, 0x70, 0x79, 0x64, 0x52, 0x39, 0x55, 0x32, 0x67, 0x66, 0x75, 0x6b,
    0x34, 0x5a, 0x72, 0x53, 0x66, 0x48, 0x61, 0x71,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x2b &&
      hash[1] == 0x01 &&
      hash[2] == 0x00 &&
      hash[3] == 0x05 &&
      hash[4] == 0xf1 &&
      hash[5] == 0x60 &&
      hash[6] == 0x71 &&
      hash[7] == 0x62 &&
      hash[8] == 0x7c &&
      hash[9] == 0x4a &&
      hash[10] == 0xcc &&
      hash[11] == 0x03 &&
      hash[12] == 0x2a &&
      hash[13] == 0x89 &&
      hash[14] == 0x40 &&
      hash[15] == 0x5a &&
      hash[16] == 0x03 &&
      hash[17] == 0xdc &&
      hash[18] == 0x83 &&
      hash[19] == 0xc8
  )

  raw = [
    0x72, 0x4c, 0x4c, 0x45, 0x36, 0x34, 0x74, 0x44, 0x4c, 0x78, 0x59, 0x37,
    0x47, 0x6f, 0x41, 0x41, 0x57, 0x66, 0x73, 0x36,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xdf &&
      hash[1] == 0xe3 &&
      hash[2] == 0x14 &&
      hash[3] == 0xf0 &&
      hash[4] == 0x5f &&
      hash[5] == 0x95 &&
      hash[6] == 0x8c &&
      hash[7] == 0x57 &&
      hash[8] == 0x2f &&
      hash[9] == 0x9d &&
      hash[10] == 0x45 &&
      hash[11] == 0xdc &&
      hash[12] == 0x12 &&
      hash[13] == 0x77 &&
      hash[14] == 0x39 &&
      hash[15] == 0xac &&
      hash[16] == 0xea &&
      hash[17] == 0x4a &&
      hash[18] == 0xb0 &&
      hash[19] == 0x8f
  )

  raw = [
    0x72, 0x50, 0x64, 0x50, 0x58, 0x77, 0x76, 0x75, 0x39, 0x4e, 0x4c, 0x59,
    0x46, 0x50, 0x34, 0x69, 0x56, 0x64, 0x56, 0x70,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xd1 &&
      hash[1] == 0x9f &&
      hash[2] == 0x25 &&
      hash[3] == 0x93 &&
      hash[4] == 0xa3 &&
      hash[5] == 0xca &&
      hash[6] == 0xea &&
      hash[7] == 0x10 &&
      hash[8] == 0x06 &&
      hash[9] == 0x78 &&
      hash[10] == 0xfc &&
      hash[11] == 0x58 &&
      hash[12] == 0xa4 &&
      hash[13] == 0x99 &&
      hash[14] == 0x3c &&
      hash[15] == 0x6e &&
      hash[16] == 0xc4 &&
      hash[17] == 0x2d &&
      hash[18] == 0x6d &&
      hash[19] == 0x53
  )

  raw = [
    0x72, 0x44, 0x65, 0x44, 0x32, 0x5a, 0x71, 0x53, 0x48, 0x35, 0x44, 0x70,
    0x51, 0x4d, 0x78, 0x76, 0x36, 0x36, 0x52, 0x6b,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x4d &&
      hash[1] == 0x5b &&
      hash[2] == 0xdd &&
      hash[3] == 0x31 &&
      hash[4] == 0xde &&
      hash[5] == 0xb9 &&
      hash[6] == 0xf5 &&
      hash[7] == 0xb8 &&
      hash[8] == 0xbd &&
      hash[9] == 0x17 &&
      hash[10] == 0xe1 &&
      hash[11] == 0x51 &&
      hash[12] == 0xaa &&
      hash[13] == 0x51 &&
      hash[14] == 0x9c &&
      hash[15] == 0x5b &&
      hash[16] == 0xe0 &&
      hash[17] == 0x15 &&
      hash[18] == 0x61 &&
      hash[19] == 0x2c
  )

  raw = [
    0x72, 0x55, 0x34, 0x78, 0x54, 0x52, 0x75, 0x6f, 0x32, 0x34, 0x62, 0x52,
    0x6f, 0x65, 0x41, 0x48, 0x33, 0x53, 0x55, 0x66,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xbd &&
      hash[1] == 0xa1 &&
      hash[2] == 0x62 &&
      hash[3] == 0x1e &&
      hash[4] == 0x84 &&
      hash[5] == 0x12 &&
      hash[6] == 0xb3 &&
      hash[7] == 0xcc &&
      hash[8] == 0x58 &&
      hash[9] == 0x19 &&
      hash[10] == 0x9a &&
      hash[11] == 0x22 &&
      hash[12] == 0xcf &&
      hash[13] == 0x6a &&
      hash[14] == 0x0a &&
      hash[15] == 0x43 &&
      hash[16] == 0xde &&
      hash[17] == 0xb5 &&
      hash[18] == 0xba &&
      hash[19] == 0x50
  )

  raw = [
    0x72, 0x6e, 0x6d, 0x6f, 0x6a, 0x57, 0x46, 0x6f, 0x41, 0x58, 0x72, 0x76,
    0x71, 0x75, 0x62, 0x6f, 0x45, 0x77, 0x4e, 0x4e,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x5f &&
      hash[1] == 0x26 &&
      hash[2] == 0xf9 &&
      hash[3] == 0x0a &&
      hash[4] == 0xc7 &&
      hash[5] == 0xd5 &&
      hash[6] == 0x40 &&
      hash[7] == 0x2d &&
      hash[8] == 0x1f &&
      hash[9] == 0x9e &&
      hash[10] == 0x46 &&
      hash[11] == 0xaa &&
      hash[12] == 0x6d &&
      hash[13] == 0x9c &&
      hash[14] == 0x64 &&
      hash[15] == 0x88 &&
      hash[16] == 0x87 &&
      hash[17] == 0xf3 &&
      hash[18] == 0x29 &&
      hash[19] == 0x72
  )

  raw = [
    0x72, 0x61, 0x33, 0x57, 0x65, 0x64, 0x69, 0x71, 0x58, 0x37, 0x34, 0x79,
    0x42, 0x42, 0x68, 0x48, 0x4c, 0x44, 0x51, 0x4d,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x25 &&
      hash[1] == 0x70 &&
      hash[2] == 0x5f &&
      hash[3] == 0x6d &&
      hash[4] == 0xa8 &&
      hash[5] == 0x60 &&
      hash[6] == 0x54 &&
      hash[7] == 0xba &&
      hash[8] == 0xd8 &&
      hash[9] == 0x33 &&
      hash[10] == 0x41 &&
      hash[11] == 0x48 &&
      hash[12] == 0x95 &&
      hash[13] == 0x52 &&
      hash[14] == 0xa6 &&
      hash[15] == 0x22 &&
      hash[16] == 0x9d &&
      hash[17] == 0x82 &&
      hash[18] == 0xa0 &&
      hash[19] == 0x87
  )

  raw = [
    0x72, 0x45, 0x47, 0x57, 0x33, 0x6b, 0x6f, 0x34, 0x41, 0x31, 0x69, 0x50,
    0x43, 0x5a, 0x54, 0x78, 0x6d, 0x77, 0x6a, 0x44,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xd4 &&
      hash[1] == 0xda &&
      hash[2] == 0xe0 &&
      hash[3] == 0xc7 &&
      hash[4] == 0x40 &&
      hash[5] == 0xc4 &&
      hash[6] == 0x28 &&
      hash[7] == 0x59 &&
      hash[8] == 0xa9 &&
      hash[9] == 0x6d &&
      hash[10] == 0x91 &&
      hash[11] == 0xdc &&
      hash[12] == 0x34 &&
      hash[13] == 0x0d &&
      hash[14] == 0xb9 &&
      hash[15] == 0xe6 &&
      hash[16] == 0xe9 &&
      hash[17] == 0x9d &&
      hash[18] == 0x04 &&
      hash[19] == 0x0b
  )

  raw = [
    0x72, 0x68, 0x52, 0x46, 0x71, 0x54, 0x35, 0x45, 0x39, 0x7a, 0x63, 0x69,
    0x70, 0x68, 0x4c, 0x54, 0x39, 0x78, 0x6a, 0x52,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x61 &&
      hash[1] == 0x5b &&
      hash[2] == 0xfe &&
      hash[3] == 0x17 &&
      hash[4] == 0x6e &&
      hash[5] == 0x81 &&
      hash[6] == 0x42 &&
      hash[7] == 0xff &&
      hash[8] == 0xee &&
      hash[9] == 0xd7 &&
      hash[10] == 0x1a &&
      hash[11] == 0x6d &&
      hash[12] == 0x14 &&
      hash[13] == 0x5d &&
      hash[14] == 0x64 &&
      hash[15] == 0xa8 &&
      hash[16] == 0x20 &&
      hash[17] == 0x1a &&
      hash[18] == 0x33 &&
      hash[19] == 0xc3
  )

  raw = [
    0x72, 0x70, 0x61, 0x4a, 0x69, 0x34, 0x4c, 0x62, 0x55, 0x36, 0x55, 0x63,
    0x4a, 0x45, 0x78, 0x62, 0x38, 0x39, 0x35, 0x5a,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x01 &&
      hash[1] == 0x61 &&
      hash[2] == 0xa4 &&
      hash[3] == 0x8e &&
      hash[4] == 0x6d &&
      hash[5] == 0x20 &&
      hash[6] == 0xba &&
      hash[7] == 0x20 &&
      hash[8] == 0x72 &&
      hash[9] == 0x72 &&
      hash[10] == 0x8f &&
      hash[11] == 0x4f &&
      hash[12] == 0x3f &&
      hash[13] == 0xe1 &&
      hash[14] == 0xe1 &&
      hash[15] == 0xe7 &&
      hash[16] == 0xeb &&
      hash[17] == 0x15 &&
      hash[18] == 0xa8 &&
      hash[19] == 0x4c
  )

  raw = [
    0x72, 0x34, 0x59, 0x78, 0x47, 0x46, 0x71, 0x51, 0x64, 0x47, 0x70, 0x71,
    0x6e, 0x4c, 0x59, 0x65, 0x4d, 0x38, 0x56, 0x52,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0x42 &&
      hash[1] == 0xc5 &&
      hash[2] == 0x2f &&
      hash[3] == 0x3b &&
      hash[4] == 0xb7 &&
      hash[5] == 0xd4 &&
      hash[6] == 0x54 &&
      hash[7] == 0xb4 &&
      hash[8] == 0x97 &&
      hash[9] == 0xb4 &&
      hash[10] == 0xfc &&
      hash[11] == 0xb0 &&
      hash[12] == 0x46 &&
      hash[13] == 0xba &&
      hash[14] == 0xb6 &&
      hash[15] == 0xad &&
      hash[16] == 0x93 &&
      hash[17] == 0x8d &&
      hash[18] == 0xeb &&
      hash[19] == 0x7d
  )

  raw = [
    0x72, 0x33, 0x76, 0x71, 0x75, 0x79, 0x72, 0x45, 0x39, 0x55, 0x53, 0x70,
    0x68, 0x62, 0x43, 0x55, 0x6d, 0x65, 0x4b, 0x55,
  ]
  hash = util_sha512h(raw)
  ASSERT(32 == hash.length)
  ASSERT(
    hash[0] == 0xd5 &&
      hash[1] == 0x6b &&
      hash[2] == 0x6b &&
      hash[3] == 0x45 &&
      hash[4] == 0x30 &&
      hash[5] == 0xf0 &&
      hash[6] == 0x34 &&
      hash[7] == 0x76 &&
      hash[8] == 0x31 &&
      hash[9] == 0x56 &&
      hash[10] == 0x8c &&
      hash[11] == 0x38 &&
      hash[12] == 0x0c &&
      hash[13] == 0x1a &&
      hash[14] == 0xaf &&
      hash[15] == 0xab &&
      hash[16] == 0x42 &&
      hash[17] == 0x16 &&
      hash[18] == 0x21 &&
      hash[19] == 0x42
  )

  accept('', 0)
}
